<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Local Community Event Portal</title>
  <style>
    /* General Styling */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      line-height: 1.6;
    }

    nav {
        background-color: #007BFF;
        padding: 10px;
        text-align: center;
        margin-bottom: 0; /* optional: remove any space below nav */
    }

nav a {
  position: relative;
  color: white;
  text-decoration: none;
  margin: 0 10px;
  font-weight: bold;
  font-size: 1.1rem;
  transition: color 0.3s ease;
}

/* ACTIVE LINK STYLING — subtle underline and color shift */
    nav a.active {
        color: #3136b5;
    }

    nav a:hover::after {
        transform: scaleX(1);
    }


    nav a:focus {
      outline: none;
      text-decoration: underline;
      outline-offset: 0;
    }

    #welcomeBanner {
        background-color: #007BFF;
        color: white;
        padding: 20px;
        text-align: center;
        font-size: 1.2rem;
        margin-top: 10px; /* adds spacing from nav */
        border-top: 2px solid white; /* optional for clear separation */
    }



    .highlight {
      background-color: yellow;
      font-weight: bold;
      color: black;
      padding: 0 4px;
    }

    .event-offer {
      color: #ffdd57;
      font-weight: bold;
      margin-left: 15px;
    }

    main {
      max-width: 1000px;
      margin: 20px auto;
      padding: 0 15px;
    }

    /* Event images grid */
    #events div {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
    }

    figure {
      margin: 0;
      text-align: center;
      width: 160px;
    }

    .event-image {
      border: 3px solid #007BFF;
      width: 150px;
      height: 100px;
      object-fit: cover;
      cursor: pointer;
      transition: transform 0.3s ease;
      display: block;
      margin: 0 auto;
    }

    .event-image:hover,
    .event-image:focus {
      transform: scale(1.1);
      outline: none;
    }

    figcaption {
      font-style: italic;
      color: #555;
      margin-top: 5px;
    }

    /* Video section */
    #promoVideo {
      display: block;
      margin: 30px auto;
      max-width: 100%;
      border: 3px solid #007BFF;
      border-radius: 8px;
    }
    
    /* Forms styling */
    form {
      max-width: 400px;
      margin: 20px auto 40px;
      padding: 15px;
      border: 2px solid #007BFF;
      border-radius: 8px;
      background-color: #f9f9f9;
    }

    form label {
      display: block;
      margin: 10px 0 5px;
      font-weight: bold;
    }

    form input, form select, form textarea {
      width: 100%;
      padding: 7px;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
      font-family: inherit;
    }

    form button {
      margin-top: 15px;
      padding: 10px;
      background-color: #007BFF;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
    }

    form button:hover,
    form button:focus {
      background-color: #0056b3;
      outline: none;
    }

    output {
      display: block;
      margin-top: 15px;
      font-weight: bold;
      color: green;
      text-align: center;
    }

    /* Footer */
    footer {
      background-color: #f8f9fa;
      text-align: center;
      padding: 10px;
      margin-top: 40px;
      border-top: 1px solid #ccc;
      font-size: 0.9rem;
      color: #555;
    }

    /* Error message styling */
    #phoneError {
      color: red;
      font-size: 0.9rem;
      margin-top: 5px;
      display: block;
    }

    /* Character count */
    #charCount {
      font-weight: bold;
      margin-top: 5px;
    }

    /* Event fee display */
    #feeDisplay {
      font-weight: bold;
      color: #28a745;
      margin-top: 5px;
    }

  </style>
</head>
<script>
  const sections = document.querySelectorAll("main section[id]");
  const navLinks = document.querySelectorAll("nav a[href^='#']");

  function setActiveLink() {
    let index = sections.length;

    while (--index >= 0 && window.scrollY + 100 < sections[index].offsetTop) {}

    navLinks.forEach(link => link.classList.remove("active"));
    if (sections[index]) {
      const activeId = sections[index].id;
      const activeLink = document.querySelector(`nav a[href="#${activeId}"]`);
      if (activeLink) activeLink.classList.add("active");
    }
  }

  window.addEventListener("scroll", setActiveLink);
  window.addEventListener("load", setActiveLink); // Set on load as well
</script>

<body>

  <!-- Navigation Bar -->
<header>
  <nav role="navigation" aria-label="Main navigation">
    <a href="#home">Home</a> |
    <a href="#events">Events</a> |
    <a href="#promo">Promo Video</a> |
    <a href="#contact">Contact</a> 
  </nav>
</header>

  <!-- Welcome Banner -->
<div id="welcomeBanner" role="banner" aria-live="polite">
  <strong>Welcome to the Local Community Event Portal!</strong>
</div>

<main>
  <section id="home" tabindex="-1">
    <h1>Welcome to Our Community Portal</h1>
    <p>Our portal connects residents with engaging and impactful community events. From environmental clean-up drives to cultural fairs and charity runs, there's something for everyone.</p>
    <p>Each event is designed to foster connection, volunteerism, and community pride. Here's how you can get involved:</p>
    <ul>
      <li><strong>Volunteer:</strong> Join hands with fellow residents to support local causes.</li>
      <li><strong>Participant:</strong> Sign up for fun and meaningful activities like charity runs, farmers markets, or food festivals.</li>
      <li><strong>Organizer:</strong> Lead an initiative and collaborate with local authorities to make a difference.</li>
      <li><strong>Supporter:</strong> Spread the word, donate, or provide logistical support to help events succeed.</li>
    </ul>
    <p>Get started by browsing our upcoming events or submitting your own ideas through the contact section below.</p>
  </section>

    <section id="events" tabindex="-1">
      <h2 class="highlight">Upcoming Events</h2>
      <div>
        <figure>
          <img src="event1.jpg" alt="Community Clean-up" title="Community Clean-up" class="event-image" tabindex="0" />
          <figcaption>Community Clean-up Day</figcaption>
        </figure>
        <figure>
          <img src="event2.jpg" alt="Farmers Market" title="Farmers Market" class="event-image" tabindex="0" />
          <figcaption>Local Farmers Market</figcaption>
        </figure>
        <figure>
          <img src="event3.jpg" alt="Charity Run" title="Charity Run" class="event-image" tabindex="0" />
          <figcaption>Annual Charity Run</figcaption>
        </figure>
        <figure>
          <img src="event4.jpg" alt="Art Fair" title="Art Fair" class="event-image" tabindex="0" />
          <figcaption>Community Art Fair</figcaption>
        </figure>
        <figure>
          <img src="event5.jpg" alt="Food Festival" title="Food Festival" class="event-image" tabindex="0" />
          <figcaption>Food Festival</figcaption>
        </figure>
        <figure>
          <img src="event6.jpg" alt="Music Concert" title="Music Concert" class="event-image" tabindex="0" />
          <figcaption>Outdoor Music Concert</figcaption>
        </figure>
      </div>
      <button id="findNearbyBtn">Find Nearby Events</button>
      <div id="geoOutput"></div>
    </section>

    <section id="promo" tabindex="-1">
      <h2>Community Promo Video</h2>
      <video id="promoVideo" controls width="640" height="360" aria-label="Community promotional video">
        <source src="promo.mp4" type="video/mp4" />
        Your browser does not support the video tag.
      </video>
    </section>

    <section id="contact" tabindex="-1">
      <h2>Contact & Register</h2>

      <!-- Event Registration Form -->
      <form id="registrationForm" novalidate aria-label="Event Registration Form">
        <h3>Register for an Event</h3>
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" placeholder="Your full name" required autofocus aria-required="true" />

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" placeholder="you@example.com" required aria-required="true" />

        <label for="date">Event Date:</label>
        <input type="date" id="date" name="date" required aria-required="true" />

        <label for="eventType">Event Type:</label>
        <select id="eventType" name="eventType" required aria-required="true">
          <option value="" disabled selected>Select an event</option>
          <option value="clean-up">Community Clean-up</option>
          <option value="farmers-market">Farmers Market</option>
          <option value="charity-run">Charity Run</option>
          <option value="art-fair">Art Fair</option>
          <option value="food-festival">Food Festival</option>
          <option value="music-concert">Music Concert</option>
        </select>

        <button type="button" id="clearPrefsBtn">Clear Preferences</button>

        <label for="message">Message (optional):</label>
        <textarea id="message" name="message" placeholder="Any special requirements?" rows="4"></textarea>

        <button type="submit">Register</button>

        <output id="confirmation" aria-live="polite" role="alert"></output>
      </form>

      <!-- Feedback Section -->
      <h3>Event Feedback</h3>

      <form id="feedbackForm" novalidate aria-label="Feedback Form">
        <label for="phone">Phone Number:</label>
        <input type="tel" id="phone" name="phone" placeholder="+91 9876543210" required aria-required="true" aria-describedby="phoneError" />
        <span id="phoneError" aria-live="assertive"></span>

        <label for="eventSelect">Select Event:</label>
        <select id="eventSelect" name="eventSelect" onchange="showFee()" required aria-required="true">
          <option value="" disabled selected>Select an event</option>
          <option value="clean-up">Community Clean-up</option>
          <option value="farmers-market">Farmers Market</option>
          <option value="charity-run">Charity Run</option>
          <option value="art-fair">Art Fair</option>
          <option value="food-festival">Food Festival</option>
          <option value="music-concert">Music Concert</option>
        </select>

        <p>Event Fee: <span id="feeDisplay" aria-live="polite">$0</span></p>

        <button type="button" id="submitBtn">Submit Feedback</button>
      </form>

    <label for="feedbackText" style="font-weight: bold; font-size: 1.1rem; display: block; margin-top: 20px;">
        We’d love your feedback!
    </label>

    <textarea 
    id="feedbackText" 
    rows="5" 
    cols="100" 
    oninput="countChars()" 
    placeholder="Share your thoughts or suggestions to help us improve..." 
    aria-describedby="charCount"
    style="border: 2px solid #007BFF; padding: 12px; border-radius: 8px; background-color: #f0f8ff; font-size: 1rem; font-family: inherit; width: 100%; box-sizing: border-box; resize: vertical;"></textarea>

    <div style="margin-top: 8px; font-size: 0.95rem; color: #333;">
    Characters typed: <span id="charCount" style="font-weight: bold; color: #007BFF;">0</span>
    </div>


      <output id="feedbackOutput" aria-live="polite" role="alert"></output>
    </section>
  </main>

  <footer role="contentinfo">
    <p>&copy; 2025 Local City Council</p>
  </footer>

  <script>
    
    // Registration form submit handler
    const regForm = document.getElementById('registrationForm');
    const confirmationOutput = document.getElementById('confirmation');

    regForm.addEventListener('submit', function(event) {
      event.preventDefault();
      const name = regForm.name.value.trim();
      const eventType = regForm.eventType.options[regForm.eventType.selectedIndex].text;
      if (name && eventType) {
        confirmationOutput.textContent = `Thank you, ${name}, for registering for the ${eventType}! We will contact you shortly.`;
        regForm.reset();
      } else {
        confirmationOutput.textContent = 'Please fill in all required fields.';
      }
    });

    // Phone validation function
    function validatePhone() {
      const phoneInput = document.getElementById('phone');
      const phone = phoneInput.value.trim();
      const phonePattern = /^\+91 \d{10}$/;
      const errorSpan = document.getElementById('phoneError');

      if (!phonePattern.test(phone)) {
        errorSpan.textContent = 'Please enter a valid Indian phone number (+91 9876543210).';
        phoneInput.setAttribute('aria-invalid', 'true');
        return false;
      } else {
        errorSpan.textContent = '';
        phoneInput.removeAttribute('aria-invalid');
        return true;
      }
    }

    // Show event fee on selection
    function showFee() {
      const fees = {
        "clean-up": "$10",
        "farmers-market": "$5",
        "charity-run": "$20",
        "art-fair": "$15",
        "food-festival": "$12",
        "music-concert": "$20"
      };
      const eventSelect = document.getElementById('eventSelect');
      const feeDisplay = document.getElementById('feeDisplay');
      const selected = eventSelect.value;
      feeDisplay.textContent = fees[selected] || "$0";
    }

    // Show feedback confirmation
    function showConfirmation() {
      const feedbackOutput = document.getElementById('feedbackOutput');
      feedbackOutput.textContent = "Thank you for your feedback!";
      // Clear feedback form fields
      document.getElementById('feedbackForm').reset();
      document.getElementById('feedbackText').value = '';
      document.getElementById('charCount').textContent = '0';
      document.getElementById('feeDisplay').textContent = '$0';
    }

    // Character count for feedback text area
    function countChars() {
      const feedbackText = document.getElementById('feedbackText');
      const charCount = document.getElementById('charCount');
      charCount.textContent = feedbackText.value.length;
    }

    // Validate phone before submitting feedback
    document.getElementById('submitBtn').addEventListener('click', function () {
      if (validatePhone()) {
        showConfirmation();
      }
    });

    // Smooth scroll for nav links
    document.querySelectorAll('nav a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.focus({preventScroll:true});
          target.scrollIntoView({ behavior: 'smooth' });
        }
      });
    });
    document.addEventListener('DOMContentLoaded', () => {
        const eventTypeSelect = document.getElementById('eventType');
        const clearPrefsBtn = document.getElementById('clearPrefsBtn');

        // Load saved event type on page load
        const savedEvent = localStorage.getItem('preferredEventType');
        if (savedEvent) {
            eventTypeSelect.value = savedEvent;
        }

        // Save preference when event type changes
        eventTypeSelect.addEventListener('change', () => {
            localStorage.setItem('preferredEventType', eventTypeSelect.value);
        });

        // Clear preferences button handler
        clearPrefsBtn.addEventListener('click', () => {
            localStorage.removeItem('preferredEventType');
            sessionStorage.clear();
            eventTypeSelect.value = "";  // Reset select
            alert('Your preferences have been cleared.');
        });
    });
      document.getElementById('findNearbyBtn').addEventListener('click', () => {
    const output = document.getElementById('geoOutput');

    // Check if browser supports geolocation
    if (!navigator.geolocation) {
      output.textContent = "Sorry, your browser doesn't support geolocation.";
      return;
    }

    output.textContent = "Trying to find your location...";

    // Ask for current position
    navigator.geolocation.getCurrentPosition(
      (position) => {
        const lat = position.coords.latitude.toFixed(5);
        const lon = position.coords.longitude.toFixed(5);
        output.textContent = `Your location:\nLatitude: ${lat}, Longitude: ${lon}`;
      },
      (error) => {
        if (error.code === error.PERMISSION_DENIED) {
          output.textContent = "You denied permission to get location.";
        } else if (error.code === error.TIMEOUT) {
          output.textContent = "Location request timed out.";
        } else {
          output.textContent = "Could not get location.";
        }
      },
      {
        enableHighAccuracy: true,
        timeout: 10000, // 10 seconds
        maximumAge: 0
      }
    );
  });
  </script>

</body>
</html>